
include ./map-toolbar.jade

ui-gmap-google-map(center='center', zoom='zoom', draggable='true',
  dragging='dragging', bounds='bounds', events='events', options='options',
  pan='true', control='control', ng-cloak=''
  ng-keydown='actions.keyDown($event)' ng-keyup='actions.keyUp($event)' tabindex='0'
)

  //ui-gmap-layer(type='TrafficLayer', show='showTraffic')
  //ui-gmap-layer(type='BicyclingLayer', show='showBicycling')
  //ui-gmap-layer(namespace='weather', type='WeatherLayer', show='showWeather')
  //two drag zooms for either keyboard or button

  ui-gmap-drag-zoom(keyboardkey='"alt"')
  ui-gmap-drag-zoom(options='dragZoom.options')


  ui-gmap-markers(ng-if="showMarkers" options='formatters.layer.MLS.markerOptionsFromForSale',
    models='layers.filterSummary',
    coords='"geom_point_json"',
    idkey='"rm_property_id"',
    events='actions.listingEvents'
    ng-cloak='',
    chunk='200'
    doCluster='true',
    clusterOptions="{ignoreHidden: true, minimumClusterSize: 4,  styles: [{textSize: 22, fontFamily:'\"Helvetica Neue\", Helvetica, Arial, " +
    "sans-serif', url:'assets/cluster_circle_blue_40.png', width:'40', height:'40', textColor:'#fff'}]}")

  ui-gmap-window(
    coords='layers.listingDetail.geom_point_json'
    show="layers.listingDetail.show"
    closeClick="actions.closeListing"
    options="listingOptions"
    templateUrl='"map-smallDetails.tpl.html"'
    templateParameter='layers.listingDetail'
  )

  // BEGIN PARCEL DATA
  ui-gmap-markers(options='formatters.layer.Parcels.labelFromStreetNum',
    models='layers.parcels',
    coords='"geom_point_json"',
    idkey='"rm_property_id"',
    ng-cloak=''
    chunk='400')

  // Would be nice to have just options without each individual attribute
  //https://github.com/angular-ui/angular-google-maps/issues/1033
  ui-gmap-polygons(models='layers.parcels',
    idkey='"rm_property_id"'
    path='"geom_polys_json"',
    fill="formatters.layer.Parcels.fill",
    stroke="{ color: '#1269D8', weight: 1.5, opacity: '1.0' }",
    visible='true', geodesic='true',
    events='actions.listingEvents'
    fit='false', editable='false', ng-cloak=''
    static='true'
    chunk='300'
    cleanchunk='500'
    control='controls.parcel'
    zIndex='2')
  //END PARCEL DATA

  include ./map-query-draw.jade
  ui-gmap-map-control(ng-if="debug" template='map-debug.tpl.html', position='top-right', index='1', controller='RealtyMaps-MapDebugCtrl')
