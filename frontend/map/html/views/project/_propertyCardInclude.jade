include ../../includes/mixins/_noteInputMixin.jade

.row
  .col-sm-6.col-xs-12
    .bordered
      .prop-image(ui-sref="property({ id: property.rm_property_id })")
        .prop-image-status.prop-image-status-md(ng-class="formatters.property.getStatusLabelClass(property,true)") {{formatters.property.getStatusLabel(property)}}
        img.project-property-image(ng-cloak ng-if="property.geometry_center.coordinates" ng-src="{{formatters.property.google.StreetView.getUrl(property, 420, 280)}}" title="{{property.title}}")
        img.project-property-image(ng-cloak ng-if="!property.geometry_center.coordinates && loadedProperties" rmaps-cdn-image ng-src="/assets/test_property.jpg" title="{{property.title}}")

      property-buttons(property='property' project='project' zoom-click='zoomClick(property)')

  .col-sm-6.col-xs-12.property-card-right
    .mobile-padding
      .property-data.property-attrs-clickable(ui-sref="property({ id: property.rm_property_id })")
        property-attributes(property='property')

      .project-card-notes
        .notes-title(ng-if="filteredNotes.length")
          a(ui-sref="projectNotes({ id: project.id })") Notes ({{filteredNotes.length || 0}})

        .list
          .item.item-border.project-note(ng-repeat="note in notes | filter:{ rm_property_id: property.rm_property_id } | orderBy:rm_inserted_time as filteredNotes")
            .note-data
              .note-date {{note.rm_inserted_time  | date:'MM/dd/yyyy'}}
              .note-author {{note.first_name}} {{note.last_name}}
              .note-text {{note.text}}

      +noteInputMixin(
        "createNoteForm_{{property.rm_property_id}}",
        "createNote(project, property)",
        "newNotes[property.rm_property_id].text",
        "createNote(project, property)"
      )
