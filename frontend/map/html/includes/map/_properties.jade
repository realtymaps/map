include ../mixins/property/_propertyAttributes.jade

.desktop-only
  .results-container.navbar-below#results-slide(ng-if="Toggles.showResults")
    .filters
      span Sort By:
      ul(ng-click="$event.stopPropagation()")
        li(ng-click="formatters.results.setOrReverseResultsPredicate('price')" ) Price
          span(class="caret {{resultsDescending ? 'desc' : 'asc'}}" ng-class="formatters.results.getSortClass('price')")
        li(ng-click="formatters.results.setOrReverseResultsPredicate('bedrooms')") Beds
          span(class="caret {{resultsDescending ? 'desc' : 'asc'}}" ng-class="formatters.results.getSortClass('bedrooms')")
        li(ng-click="formatters.results.setOrReverseResultsPredicate('sqft_finished')") Sq Ft
          span(class="caret {{resultsDescending ? 'desc' : 'asc'}}" ng-class="formatters.results.getSortClass('sqft_finished')")
        li(ng-click="formatters.results.setOrReverseResultsPredicate('year_built')") Year
          span(class="caret {{resultsDescending ? 'desc' : 'asc'}}" ng-class="formatters.results.getSortClass('year_built')")
    #results-list-container(infinite-scroll='formatters.results.loadMore(false)' infinite-scroll-distance='1' infinite-scroll-container='"#results-list-container"')
      #results-list.list()
        ul.list
          li(ng-repeat="property in formatters.results.getResultsArray() | orderBy:resultsPredicate:resultsDescending | limitTo:resultsLimit"
          ng-click="formatters.results.click(property,property);showDetails = !showDetails")
            .property-card
              div.property-img
                span.status(ng-class="formatters.property.getStatusLabelClass(property,true)") {{property.status}}
                img(ng-cloak ng-src="{{formatters.property.google.StreetView.getUrl(property, 245, 163)}}" title="{{property.title}}")
              +propertyAttributes('property')
              property-buttons(property='property'
                              pin-click='formatters.results.clickSaveResultFromList(property, $event); $event.stopPropagation()'
                              favorite-click='formatters.results.clickFavoriteResultFromList(property, $event); $event.stopPropagation()'
                              )

.mobile-only
  #detail-card-tray(ng-controller="rmapsSwipeTrayCtrl")
    #detail-card-container(ng-swipe-left="swipeLeft()" ng-swipe-right="swipeRight()")
      .detail-card(ng-repeat="property in formatters.results.getResultsArray() | orderBy:resultsPredicate:resultsDescending | limitTo:resultsLimit"
      ng-class="trayPosition($index)"
      ng-click="cardClick($index, property)")
        .property-img
          .status(ng-class="formatters.property.getStatusLabelClass(property,true)") {{property.status}}
          img(rmaps-cdn-image ng-src="{{formatters.property.google.StreetView.getUrl(property, 85, 85)}}" title="{{property.title}}")
        .card-info
          a.pinto(
            ng-click="formatters.results.clickSaveResultFromList(property, $event); $event.stopPropagation()"
            popover-placement="left"
            popover-trigger="'mouseenter touchend'"
            uib-popover="{{formatters.property.isPinnedResult(property) ? 'Unpin' : 'Pin'}}"
            ng-class="{ 'pinned': formatters.property.isPinnedResult(property) }")
            span.icon.icon-pin
          +propertyAttributes('property')
