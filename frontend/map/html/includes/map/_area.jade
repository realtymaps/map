include ../mixins/_circleNrMixin.jade

span(
  ng-hide="Toggles.getHideAnyDraw()"
  class="dropdown btn-group area-list"
  ng-controller="rmapsMapAreasCtrl"
  dropdown
  auto-close="disabled"
  is-open="isOpens.area"
  on-toggle="areaListToggled(open); togglePanel('area')"
)
    div(ng-if="isOpen" ng-controller="rmapsDrawAreaCtrl")
    button.btn.btn-transparent.dropdown-toggle.area.nav-btn.toggle-active(
    dropdown-toggle
    popover-placement="bottom"
    popover="Areas"
    popover-trigger="click mouseenter"
    popover-enable="!isOpens.area")
      span.icon.icon-area
    .dropdown-menu.whiteblock(ng-controller="rmapsAreasModalCtrl")
      .fixed-header
        span
          a(ng-show="_.keys(areas).length" ui-sref="projectAreas({id: principal.getCurrentProfile().project_id})") {{_.keys(areas).length}} Areas
          span(ng-show="!_.keys(areas).length") No Areas
        span.results-btn(
          popover-placement="right"
          popover-trigger="mouseenter"
          popover="Add Area"
          ng-click="Toggles.toggleIsAreaDraw()")
            span.icon.icon-add_area
            span Draw New Area
      .inner
        ul(ng-controller="rmapsAreasModalCtrl")
          li(ng-repeat="model in areas | orderBy:'properties.area_name'" ng-click="centerOn(model)")
            span.content
              +circleNrMixin("{{$index+1}}")
              p.title {{model.properties.area_name}}

            span.actions(rmaps-require-project-editor)
              span.fa.fa-edit(ng-click="update(model); $event.stopPropagation()")
              span.fa.fa-envelope(ng-click="sendMail(model); $event.stopPropagation()")
              span.fa.fa-bar-chart(ng-click="showStats(model); $event.stopPropagation()")
              span.icon.icon-remove(ng-click="remove(model); $event.stopPropagation()")
