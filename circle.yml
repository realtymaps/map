machine:
  node:
    version: v0.10.31
dependencies:
  post:
    # use --production to exclude devDependencies, important to test this way
    # since (I think) Heroku will install like this
    - npm --production install
    #- npm install -g coffee-script mocha gulp coffeegulp cgulp karma karma-cli webpack webpack-dev-server
deployment:
  prod:
    branch: master
    commands:
      # the pushTo script contains a safety check; it won't actually do
      # anything if CircleCI is running on master of any fork other than the
      # main realtymaps repo.  It also handles db forking and other important
      # things like setting some environment variables 
      - ./scripts/pushTo heroku realtymaps-map
      - ./scripts/pushTo github realtymapsDev/map

  staging_nmccready:
    branch: /feature\/nick_mc.*/
    commands:
      - ./scripts/pushTo heroku nmccready-realtymaps-map

  staging_dan:
    branch: /feature\/dan.*/
    commands:
      - ./scripts/pushTo heroku dan-realtymaps-map

  staging_joe:
    branch: /feature\/joe.*/
    commands:
      - ./scripts/pushTo heroku joe-realtymaps-map
